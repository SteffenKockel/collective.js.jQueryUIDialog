if(jQuery){(function(a){a.extend(a.fn,{_open_dialogs:new Array(),_dialog_configs:{},_Dialog2_cfg:{modal:false,closeOnEscape:true,dialogClass:"rahmenbuch-dialog-window",draggable:true,resizable:false,width:600,create:false,close:undefined,drag:false,dragStart:false,dragStop:false,position:"top",IdFromTimestamp:false,IdPlusTimestamp:false,ajaxLoad:false,noForm:false,noFormAction:"follow",successCallback:undefined,cancelCallback:undefined,closeCallback:undefined,noFormCallback:undefined,nextViewAfterNoForm:"view",forceNextViewAfterNoForm:false,nextViewAfterCancel:"view",menu:true,preserveMenu:false,tabs:true,wysiwyg:true,calendar:true,saveButton:"save",cancelButton:"cancel",},block_dialog:function(b){a("div#"+b).animate({opacity:0});a("div#"+b).wrap('<span class="loading" id="loading-'+b+'" />');return true},unblock_dialog:function(b){a("div#"+b).animate({opacity:1});a("div#"+b).unwrap();return true},Dialog:function(l,h,m){var g=a.extend({},a.fn._Dialog2_cfg);var d=l.href;if(!h){h=l.href.split("/").slice(-1)[0]}if(!m){if(g.IdFromTimestamp==true){m=(new Date).getTime()}else{if(l.id){m="dialog-"+l.id;if(g.IdPlusTimestamp==true){m=m+"-"+(new Date).getTime()}}else{m="dialog-"+l.href.split("/").slice(-2)[0]}}}if(a.fn._dialog_configs[h]){a.extend(g,a.fn._dialog_configs[h])}function e(){a.fn.block_dialog(m);return true}function f(){a.fn.unblock_dialog(m);return true}function i(n,o,p){a("#"+o+' [name="form.buttons.'+p.saveButton+'"]').unbind().bind("click",function(q){q.preventDefault();var c=a("#"+o+" form");form=c.serialize();form+="&form.buttons."+p.saveButton;j(c.attr("action")+"?"+form,n,o,p)});return true}function k(c){a("#"+c+' [name="form.buttons.'+g.cancelButton+'"]').unbind().bind("click",function(n){n.preventDefault();b.dialog("close")});return true}function j(o,n,p,q){e();console.log("context:",o);console.log("view:",n);console.log("selector",p);console.log("config",q);if(q.ajaxLoad==true){o=o+"?ajax_load="+(new Date()).getTime()}a.ajax({url:o,method:"GET",cache:false,success:function(x){var w=a(x);if(q.noForm!=false){var u=w.find(q.noForm);if(a(u).length==0){if(q.noFormCallback){q.noFormCallback(p,x)}if(q.noFormAction=="close"){b.dialog("close");var v=w.find(".portalMessage");console.log(a(v).html());a(".portalMessage").replaceWith(a(v).each(function(z,y){a(y).html()}));a.fn.delay(function(){a("dl.portalMessage").fadeOut()},3000);return true}if(q.noFormAction=="follow"){n=q.nextViewAfterNoForm;q=a.fn._Dialog2_cfg;if(a.fn._dialog_configs[n]){a.extend(q,a.fn._dialog_configs[n])}console.log("context:",o);console.log("view:",n);console.log("selector",p);console.log("config",q)}}}if(q.menu==true&&q.preserveMenu==false){var s=w.find("div#edit-bar");var c=s.find("#plone-contentmenu-actions ul");var t=s.find("#content-views").remove();if(c.length==0){c='<li><dl class="actionMenu deactivated" id="'+p+'plone-contentmenu-actions">';c+='<dt class="actionMenuHeader label-"><a title=Aktionen href="#">';c+='<span>Aktionen</span><span class="arrowDownAlternative"> â–¼ ';c+='</span></a></dt><dd class="actionMenuContent"><ul>';c+=a(t).html()+"</ul></dd></dl></li>";if(s.find("#contentActionMenus").html()){s.find("#contentActionMenus").append(c)}else{s.find(".contentActions").append('<ul id="contentActionMenus">'+c+"</ul>")}}else{a(c).prepend(a(t).children())}a(["actions","workflow","factories","display"]).each(function(z,y){s.find("#plone-contentmenu-"+y).attr("id",p+"-plone-contentmenu-"+y)});b.dialog("option","title",'<span id="'+p+'-dialog-title">'+s.html()+"</span>");if(s.html()!=undefined){a("#"+p+"-dialog-title a").each(function(z,y){a(y).unbind().bind("click",function(C){C.preventDefault();var A=this.href.split("/").slice(-1)[0];if(!a.fn._dialog_configs[A]){A="view"}var D=a.fn._Dialog2_cfg;var B=a.fn._dialog_configs[A];if(B){a.extend(D,B)}j(this.href,A,p,D)})});a.getScript("dropdown.js")}}else{if(q.menu==false&&q.preserveMenu==false){var r=w.find(".documentFirstHeading").remove();b.dialog("option","title",r.text())}}if(q.ajaxLoad==true){a("#"+p).empty().append(x)}else{a("#"+p).html(w.find("#content"));w.filter("script").each(function(){a.globalEval(this.text||this.textContent||this.innerHTML||"")})}if(q.tabs==true){b.ploneTabInit()}if(q.wysiwyg==true){}i(n,p,q);k(p);if(q.successCallback){q.successCallback(p,x)}f()}});return true}if(a.fn._open_dialogs.indexOf(m)!=-1){a("#"+m).dialog("moveToTop").parent().effect("highlight");return true}a.fn._open_dialogs.push(m);var b=a('<div id="'+m+'"></div>');a.extend(g,{close:function(n,c){a.fn._open_dialogs.splice(a.fn._open_dialogs.indexOf(m));if(g.closeCallback){g.closeCallback(m)}b.remove()}});b.append('<span id="loading-'+m+'" class="loading">');b.dialog(g);j(d,h,m,g)},})})(jQuery)}jQuery(function(a){a.widget("ui.dialog",a.extend({},a.ui.dialog.prototype,{_title:function(b){if(!this.options.title){b.html("&#160;")}else{b.html(this.options.title)}}}))});